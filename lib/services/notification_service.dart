import 'package:flutter_local_notifications/flutter_local_notifications.dart';
import 'package:shared_preferences/shared_preferences.dart';
import 'package:workmanager/workmanager.dart';

const String simplePeriodicTask = "simplePeriodicTask";
final FlutterLocalNotificationsPlugin flutterLocalNotificationsPlugin =
    FlutterLocalNotificationsPlugin();

const List<String> educationalTips = [
  ' ุงูุงุณุชูุงุน ูุทููู ูุนุฒุฒ ุซูุชู ุจููุณู.',
  '  ุงุญุฑุตู ุนูู ููุช ููู ูุงูู ูุทููู.',
  '  ุดุงุฑูู ุทููู ุงููุนุจ ูุชูููู ุนุงููู.',
  '  ุงูุฏุญู ุงูุฌูุฏ ุฃูุซุฑ ูู ุงููุชูุฌุฉ'
      '  ุงููุฑุงุกุฉ ุงูููููุฉ ุชุทูุฑ ุฎูุงู ุงูุทูู ๐โจ',
  ' ูู ูููุฉ ุชููููููุง ูุทููู ุชูุดููู ุตูุฑุชู ุนู ููุณู. ุงุฎุชุงุฑู ูููุงุชู ุจุญุจ. ๐ฌ๐',
  ' ุงูุงุญุชุถุงู ุงููููู ููููู ุงูุนูุงูุฉ ูููุดุนุฑ ุงูุทูู ุจุงูุฃูุงู. ๐ค๐',
  ' ุงุณุชูุนู ูุจู ุฃู ุชูุนููููุ ูุงูุฃุทูุงู ูุญุชุงุฌูู ููู ูููููู ุฃูููุง. ๐๐ง',
  ' ุงูุชุฑุจูุฉ ุงูุฅูุฌุงุจูุฉ ูุง ุชุนูู ุบูุงุจ ุงูุญุฏูุฏุ ุจู ุชุนูู ุงุญุชุฑุงู ุงูุทูู ุนูุฏ ูุถุนูุง. ๐งโค๏ธ',
  ' ูู ูุญุธุฉ ุบุถุจ ูู ูุฑุตุฉ ูุชุนููู ุทููู ููู ูุชุญูู ุจูุดุงุนุฑู. ๐๐งโโ๏ธ',
  ' ูุฏูุฉ ุงูุทูู ุงูุฃููู... ูู ุฃูุชู. ูููู ูุง ุชุชูููู ุฃู ูููู ุนููู. ๐ฉโ๐งโ๐ฆ๐ซ',
  ' ูุง ุจุฃุณ ุฃู ุชุฎุทุฆู... ุงูุฃูู ุฃู ุชุนุชุฐุฑู ูุชุนููู ุทููู ููุฉ ุงูุงุนุชุฑุงู ุจุงูุฎุทุฃ. ๐โจ',
  ' ุทููู ูุง ูุญุชุงุฌ ุฃููุง ูุซุงููุฉุ ุจู ุฃููุง ุญูููุฉ ุญุงุถุฑุฉ ุจููุจูุง. ๐',
  ' ุนูุฏูุง ูุณุชูุน ุงูุทูู ูุตูุชู ุจููุทูุ ูุชุนูู ุฃู ุงููุทู ูู ุงูููุฉ. ๐ฟ',
  ' ุฑููุฒู ุนูู ุงูุณูููุ ูุง ุนูู ุงูุดุฎุต. ูููู "ุชุตุฑูู ุฎุงุทุฆ" ุจุฏููุง ูู "ุฃูุช ุณูุก". ๐ซโก๏ธโ',
  ' ูุง ุชูุงุฑูู ุทููู ุจุบูุฑูุ ูุงุฑููู ุจููุณู ููู ูุงู ูููู ุฃุตุจุญ. ๐๐ง',
  ' ุงููุนุจ ูุน ุทููู ูู ุงุณุชุซูุงุฑ ูู ูุดุงุนุฑูุ ูููุณ ูุถูุนุฉ ููููุช. ๐งธโฐ',
  ' ุฑุฏ ุงููุนู ุงููุงุฏุฆ ููุช ุงูุบุถุจุ ุฃููู ูู ุฃู ุนูุงุจ. ๐๐ฅ',
  ' ูู ุฌููุฉ:"ุฃูุง ูุฎูุฑุฉ ุจู" ุชุฒุฑุน ุซูุฉ ุชุฏูู ุนูุฑูุง. ๐๐ซถ',
  ' ุงุฌุนูู ุจูุชู ููุงุฐูุง ุขูููุงุ ูุง ููุงููุง ููุฎูู ูุงูููู. ๐กโค๏ธ',
  ' ุทููู ูุชุนูู ููุง ุชูุนููู ุฃูุซุฑ ููุง ุชููููู. ๐๐',
  ' ูุจุฑุฉ ุตูุชู ุชุตุจุญ ุตูุช ุถููุฑ ุทููู ูุงุญููุง. ุงุฌุนูููุง ุฏุงูุฆุฉ. ๐๏ธ๐ฌ',
  ' ุงูุฑูุชูู ุงููููู ูุฌุนู ุงูุทูู ูุดุนุฑ ุจุงูุฃูุงู ูุงูุงูุถุจุงุท. ๐โณ',
  ' ุงูุตุฑุงุฎ ูุง ูุนูููุ ุจู ูุฎูู. ูุงูุชุฑุจูุฉ ูุง ุชุญุชุงุฌ ุชุฑููุจูุง. ๐ซ๐ข',
  ' ุงุญุชุถูู ุทููู ุจุฏูู ุณุจุจุ ูุงูุญุจ ูุง ูุญุชุงุฌ ููุงุณุจุฉ. ๐',
  ' ุงูุชุฑุจูุฉ ุงูุฅูุฌุงุจูุฉ ูู ุชุฑุจูุฉ ุจุงููุฑุจุ ูุง ุจุงููุณูุฉ.',
  ' ุณููู ุงูุทูู ุฑุณุงูุฉ... ุงุณุชูุนู ููุง ุฎูู ุงูุชุตุฑู. ๐ง๐ญ',
  ' ููุช ุงูุฎุทุฃ ูู ููุช ุงูุชุนูููุ ูุง ููุช ุงูุฅูุงูุฉ. โฑ๏ธ๐',
  ' ุทููู ูุง ูุนุงูุฏู... ุฅูู ูุฎุชุจุฑ ุญุฏูุฏ ุงูุนุงูู ูู ุฎูุงูู. ๐๐ถ',
  ' ูู ูุฑุฉ ุชุชูุงูููู ูููุง ุจุฏููุง ูู ุงูุนูุงุจุ ุชุจููู ุฌุณุฑูุง ุจุฏู ุฌุฏุงุฑ. ๐งฑโก๏ธ๐',
  ' ูุดุงุนุฑ ุงูุทูู ุญููููุฉุ ุญุชู ูุฅู ูุงูุช ุจุณูุทุฉ ูู ูุธุฑู. ๐กโค๏ธ',
  ' ูู ูู ูุฑุฉ ุชุชุญูููู ูู ุฃุนุตุงุจูุ ุชุนููููู ุทููู ุงูุชุญูู ูู ููุณู. ๐๐ง',
  ' ุงูุนูุงู ููุตูุญ ูุง ูุง ุชุตูุญู ุงููููุงุช. ๐ค๐ฉท',
  ' ุฃุญูุงููุง ูู ูุง ูุญุชุงุฌู ุทููู ูู ุฃู ุชูุฒูู ููุณุชูุงู ูุชุณูุนูู ุจุนูููู. ๐๐ฌ',
  ' ูุง ุชููุซุฑู ูู "ูุง"... ุงุฌุนูููุง ุนูุฏ ุงูุถุฑูุฑุฉุ ููุดุนุฑ ุจุฃุซุฑูุง. ๐โโ๏ธ๐',
  ' ุงูุซูุฉ ุชูุฒุฑุน ุจูููุฉุ ูุชููุฏู ุจุชุฌุงูู. ๐ฑ๐ง',
  ' ุงูููุงุฑูุฉ ุชุณุฑู ุทููู ูู ููุณู. ุฏุนูู ูุชูุชุญ ุนูู ุทุฑููุชู. ๐ธ',
  ' ุทููู ูุง ูุชุฐูุฑ ูุง ููุชูุ ุจู ููู ุฌุนูุชูู ูุดุนุฑ. ๐ญโค๏ธ',
  ' ุงูุทูู ูุซูุฑ ุงูุญุฑูุฉ ููุณ "ูุดุงุบุจูุง"ุ ุจู ูุถููู ููุชุดู ุงูุญูุงุฉ. ๐โโ๏ธ๐',
  ' ุงููุญู ุทููู ูุฑุตุฉ ููุงุฎุชูุงุฑุ ููุชุนูู ุชุญููู ุงููุณุคูููุฉ. โโ',
  ' ุงูุฑูุชูู ูุงููุธุงู ูุง ูููููุฏุงู ุงูุทููุ ุจู ูููุญุงูู ุฃูุงููุง. ๐๏ธ๐',
  ' ูููู ุงูุฃู ุงูุชู ุชุชููู ุทููุชูุง ุฃู ุชุตุจุญ ูุซููุง. ๐ฉโ๐งโจ',
  ' ุงูุงุนุชุฐุงุฑ ูู ุทููู ูุง ููููุต ูู ูููุชูุ ุจู ููุนููู ุงูุงุญุชุฑุงู ุงูุญูููู. ๐โโ๏ธโค๏ธ',
  ' ูููุง ุฒุงุฏ ุตุจุฑูุ ุฒุงุฏุช ูุณุงุญุฉ ุงูุชูุงูู ุจููููุง. โณ๐งฉ',
  ' ุงูุฃุทูุงู ูุง "ูุฎุชุจุฑูู ุตุจุฑู"ุ ุจู ูุจุญุซูู ุนู ูุฑุจู. ๐ซ',
  ' ูููู ูุฑุขุฉ ุทููู ุงูุนุงูุณุฉ ููุฃูุงูุ ูุง ููุชูุฏูุฏ. ๐ช๐ก๏ธ',
  ' ุงููุตุต ูุจู ุงูููู ุชุตูุน ุฐูุฑูุงุช ุชุจูู ูู ุงูููุจ ููุฃุจุฏ. ๐๐',
  ' ุณููู ุงูุทูู ูู ุงูุฎุงุฑุฌ ูุนูุณ ูุง ูุดุนุฑ ุจู ูู ุงูุฏุงุฎู. ๐๐ง',
  ' ูุง ุชุชุนุงููู ูุน ุงูุทูู ููุฃูู "ุตุบูุฑ"ุ ุจู ูุดุฎุต ูุณุชุญู ุงูุงุญุชุฑุงู. ๐ค๐ง',
  ' ุงูููุช ุงูุฐู ุชูุถููู ูุน ุทููู ุฃูู ูู ุนุฏุฏ ุงูุฏุฑูุณ ุงูุชู ุชุนูููููู ุฅูุงูุง. โฐโค๏ธ๐',
  ' ุชูุจูู ุทููู ูู ูู ุญุงูุงุชู... ููุณ ููุท ุญูู ูููู ูุทูุนูุง. ๐ง๐',
  ' ุทููู ูุชุนูู ููู ููุญุจ ููุณู ูู ุทุฑููุฉ ุญุจู ูู. ๐ชโค๏ธ',
  ' ูุจุฑุฉ ุงูุญูุงู ุชุบููุฑ ูุชุงุฆุฌ ุงูููุงุด ุฃูุซุฑ ูู ุฃู ุชูุฏูุฏ. ๐ต๐ค',
  ' ูุง ุชุณุฃูู ุงูุทูู "ููุด ุณููุช ูุฐุงุ"ุ ุจู ุงุณุฃููู "ููู ููุช ุชุญุณ ููุชูุงุ" ๐ค๐ญ',
  ' ุงูุทูู ูุง ูุญุชุงุฌ ูู ุดูุก... ูู ูุญุชุงุฌู ุฃูุช. ๐ซถ',
  ' ูุง ุชุนุงูุฌู ุงูุฎุทุฃ ุจุงูุบุถุจุ ุจู ุจุงููุฏูุก ูุงูููู. ๐ค๏ธ๐ธ',
  ' ูู ูู ูุฑุฉ ุชุตุบูู ูู ุจุตุฏูุ ุชูููู ุฌุณุฑู ูุญูู. ๐๐',
  ' ุฃุธูุฑู ุญุจู ุจุงูููู ูุงููุนูุ ูุงูุญุจ ุงูุบูุฑ ูุนูู ูุฏ ูุง ููููู. ๐ฌ๐',
  ' ุนูุฏูุง ุชูุธูุฑูู ุงูุถุนู ุฃุญูุงููุงุ ุชูุนููููู ุทููู ุงูุดุฌุงุนุฉ ุงูุญููููุฉ. ๐ซ๐ก',
  ' ุทููู ูุง ูุญุชุงุฌู "ูุซุงููุฉ"ุ ูุญุชุงุฌู "ูุชูุงุฌุฏุฉ ุจุญุจ". ๐๏ธ',
  ' ุชุฐููุฑู: ุฎูู ูู ุณููู ูุฒุนุฌุ ุงุญุชูุงุฌ ุบูุฑ ููุจู. ๐๐',
  ' ูุนูุ ุงูุชุฑุจูุฉ ูุฑููุฉ... ููู ูู ูุญุธุฉ ูููุง ุชุจูู ุฅูุณุงููุง ุนุธูููุง. ๐๏ธ๐',
  ' ุงูุทูููุฉ ูุฑุญูุฉ "ุจูุงุก"ุ ูุง "ุถุจุท". ูุง ุชุชุนุฌูู ุงููุชูุฌุฉ. ๐๏ธ๐งฑ',
  ' ูู ูุฑุฉ ุชูุฏุญูู ุฃุฎูุงู ุทูููุ ุฃูุชู ุชุจููููุง ููู ุฃูุซุฑ. ๐๐ผ',
  ' ุงูุฃูููุฉ ุฑุญูุฉ ุชุนููู ูุชุจุงุฏูุ ูุง ุฏูุฑ ุชุนูููู ูู ุทุฑู ูุงุญุฏ. ๐งญ๐ฉโ๐งโ๐ฆ',
  ' ูุง ุชูุชูู ุจููุงู ุงูุจูุช ุฃูุซุฑ ูู ุฏูุก ุงูููุจ ุงูุฐู ูุณููู. ๐โค๏ธ',
  ' ูููุง ุดุนุฑุชู ุจุงูุฅุฑูุงูุ ุชุฐูุฑู ุฃู ูุฌูุฏู ูุญุฏู ูุฏูุฉ ูุทููู. ๐๐ซถ',
  ' ุฅุฐุง ุฃุฑุฏุชู ุฃู ููุตุช ุทููู ููุ ุงุจุฏุฆู ุฃูุช ุจุงูุฅูุตุงุช ูู. ๐๐',
];

Future<void> initializeNotificationService() async {
  const AndroidInitializationSettings initializationSettingsAndroid =
      AndroidInitializationSettings('@mipmap/ic_launcher');

  const InitializationSettings initializationSettings = InitializationSettings(
    android: initializationSettingsAndroid,
  );

  await flutterLocalNotificationsPlugin.initialize(initializationSettings);

  await Workmanager().initialize(callbackDispatcher, isInDebugMode: false);

  await Workmanager().registerPeriodicTask(
    "1",
    simplePeriodicTask,
    frequency: const Duration(minutes: 15),
  );
}

@pragma('vm:entry-point')
void callbackDispatcher() {
  Workmanager().executeTask((task, inputData) async {
    const AndroidInitializationSettings initializationSettingsAndroid =
        AndroidInitializationSettings('@mipmap/ic_launcher');

    const InitializationSettings initializationSettings =
        InitializationSettings(android: initializationSettingsAndroid);

    await flutterLocalNotificationsPlugin.initialize(initializationSettings);

    final prefs = await SharedPreferences.getInstance();
    int currentTipIndex = prefs.getInt('tipIndex') ?? 0;
    final String tip = educationalTips[currentTipIndex];

    const AndroidNotificationDetails androidDetails =
        AndroidNotificationDetails(
          'your_channel_id',
          'your_channel_name',
          channelDescription: 'your_channel_description',
          importance: Importance.max,
          priority: Priority.high,
        );

    const NotificationDetails notificationDetails = NotificationDetails(
      android: androidDetails,
    );

    await flutterLocalNotificationsPlugin.show(
      0,
      'ูุตูุญุฉ ุชุฑุจููุฉ',
      tip,
      notificationDetails,
    );

    currentTipIndex = (currentTipIndex + 1) % educationalTips.length;
    await prefs.setInt('tipIndex', currentTipIndex);

    return Future.value(true);
  });
}
